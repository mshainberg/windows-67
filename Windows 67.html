<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />

<style id="webmakerstyle">

</style>
</head>
<body>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows 67 - Modern Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Wix+Madefor+Text:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --win-gray: #e0e0e0;
            --win-dark: #a0a0a0;
            --win-light: #ffffff;
            --win-black: #1a1a1a;
            --win-blue: #2563eb;
            --win-blue-dark: #1e40af;
        }

        body {
            font-family: 'Wix Madefor Text', sans-serif;
            overflow: hidden;
            user-select: none;
            cursor: default;
            background-color: #2563eb;
            background-image: url('https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=2072&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            transition: background-image 0.3s ease;
        }

        .win-border-out {
            border: 1px solid rgba(255,255,255,0.4);
            backdrop-filter: blur(10px);
            background-color: rgba(224, 224, 224, 0.9);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3), 0 8px 10px -6px rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            position: absolute; 
            /* Removed layout transitions during drag to prevent lag */
            will-change: transform, top, left, width, height;
        }

        .win-border-out.maximized {
            width: 100% !important;
            height: calc(100% - 50px) !important;
            top: 0 !important;
            left: 0 !important;
            border-radius: 0;
            border: none;
            transition: all 0.2s ease;
        }

        .win-border-in {
            background-color: white;
            border-radius: 8px;
            border: 1px solid #d1d5db;
        }

        .win-btn {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            transition: all 0.1s;
        }
        
        .win-btn:hover { background: #e5e7eb; }
        .win-btn:active { transform: scale(0.95); background: #d1d5db; }

        .title-bar {
            background: rgba(255, 255, 255, 0.5);
            color: var(--win-black);
            font-weight: 700;
            padding: 10px 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            cursor: default; 
        }

        .desktop-icon {
            width: 90px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
            cursor: pointer;
            padding: 10px;
            border-radius: 8px;
            transition: background 0.2s;
        }

        .desktop-icon:hover { background: rgba(255,255,255,0.15); }
        .desktop-icon img { width: 48px; height: 48px; margin-bottom: 6px; }

        #start-menu {
            position: absolute;
            bottom: 60px;
            left: 10px;
            width: 300px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 16px;
            display: none;
            z-index: 100000;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
            padding: 10px;
        }

        .menu-item {
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: background 0.2s;
        }

        .menu-item:hover { background: rgba(37, 99, 235, 0.1); color: var(--win-blue); }

        .window {
            position: absolute;
            display: none; 
            flex-direction: column;
            min-width: 250px;
            min-height: 150px;
            overflow: hidden;
            pointer-events: auto;
        }

        .window-content { flex-grow: 1; overflow: auto; }

        .resize-handle {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 20px;
            height: 20px;
            cursor: nwse-resize;
            z-index: 50;
            background: linear-gradient(135deg, transparent 50%, rgba(0,0,0,0.1) 50%);
            border-bottom-right-radius: 10px;
        }
        .window.maximized .resize-handle { display: none; }

        #taskbar {
            height: 50px;
            background: rgba(255, 255, 255, 0.75);
            backdrop-filter: blur(15px);
            border-top: 1px solid rgba(255, 255, 255, 0.3);
            display: flex;
            align-items: center;
            padding: 0 10px;
            position: absolute;
            bottom: 0;
            width: 100%;
            z-index: 100000;
        }

        #start-btn {
            background: var(--win-blue);
            color: white;
            border-radius: 10px;
            padding: 6px 16px;
            font-weight: 800;
            border: none;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
            margin-right: 12px;
        }

        .taskbar-item {
            width: 40px;
            height: 40px;
            margin: 0 4px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0,0,0,0.03);
            transition: all 0.2s;
            position: relative;
        }

        .taskbar-item.active {
            background: rgba(255, 255, 255, 0.8);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .taskbar-item.active::after {
            content: '';
            position: absolute;
            bottom: 4px;
            left: 25%;
            width: 50%;
            height: 3px;
            background: var(--win-blue);
            border-radius: 2px;
        }

        .taskbar-item img {
            width: 24px;
            height: 24px;
        }

        .explorer-sidebar-item {
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.875rem;
            transition: background 0.2s;
        }
        .explorer-sidebar-item:hover { background: rgba(0,0,0,0.05); }
        .explorer-sidebar-item.active { background: rgba(37, 99, 235, 0.1); color: var(--win-blue); font-weight: 600; }
        
        .file-grid-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .file-grid-item:hover { background: rgba(37, 99, 235, 0.05); }

        #camera-video { width: 100%; height: 100%; object-fit: cover; border-radius: 8px; background: #000; }
        
        /* Utility to prevent text selection during drag */
        .dragging {
            user-select: none !important;
        }
    </style>
</head>
<body class="h-screen w-screen overflow-hidden">

    <div class="absolute top-4 left-4 grid grid-flow-row gap-2 z-10" id="desktop-icons"></div>

    <div id="desktop-area" class="w-full h-full relative overflow-hidden pb-[50px] pointer-events-none">
        
        <!-- Welcome Window -->
        <div id="win-welcome" class="window win-border-out" style="width: 420px; top: 100px; left: 100px;">
            <div class="title-bar">
                <div class="flex items-center gap-2 pointer-events-none"><img src="https://api.iconify.design/flat-color-icons:home.svg" class="w-5 h-5">Welcome</div>
                <div class="flex gap-2">
                    <button class="win-btn px-2 text-lg" onclick="WindowManager.minimize('win-welcome')">−</button>
                    <button class="win-btn px-2 text-sm" onclick="WindowManager.toggleMaximize('win-welcome')">▢</button>
                    <button class="win-btn px-2 text-lg text-red-500" onclick="WindowManager.close('win-welcome')">×</button>
                </div>
            </div>
            <div class="window-content text-center p-15">
                <img src="https://api.iconify.design/flat-color-icons:template.svg" class="w-20 h-20 mx-auto mb-4 mt-10">
                <h1 class="text-2xl font-extrabold text-gray-800">Windows 67</h1>
                <p class="text-gray-600 mb-6">Modern Edition</p>
                <button class="win-btn mt-6 px-8 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold border-none shadow-lg shadow-blue-500/30" onclick="WindowManager.close('win-welcome')">Get Started</button>
            </div>
        </div>

        <!-- Camera App -->
        <div id="win-camera" class="window win-border-out" style="width: 500px; height: 450px; top: 80px; left: 300px;">
            <div class="title-bar">
                <div class="flex items-center gap-2 pointer-events-none"><img src="https://api.iconify.design/flat-color-icons:camera.svg" class="w-5 h-5">Camera</div>
                <div class="flex gap-2">
                    <button class="win-btn px-2 text-lg" onclick="WindowManager.minimize('win-camera')">−</button>
                    <button class="win-btn px-2 text-sm" onclick="WindowManager.toggleMaximize('win-camera')">▢</button>
                    <button class="win-btn px-2 text-lg text-red-500" onclick="CameraApp.stop(); WindowManager.close('win-camera')">×</button>
                </div>
            </div>
            <div class="window-content bg-black flex flex-col p-4">
                <div class="relative flex-grow overflow-hidden rounded-lg mb-4">
                    <video id="camera-video" autoplay playsinline></video>
                    <div id="camera-flash" class="absolute inset-0 bg-white opacity-0 transition-opacity pointer-events-none"></div>
                </div>
                <div class="flex justify-center items-center">
                    <button class="win-btn w-14 h-14 rounded-full flex items-center justify-center bg-white border-4 border-gray-300" onclick="CameraApp.takePhoto()">
                        <div class="w-10 h-10 rounded-full bg-red-500"></div>
                    </button>
                </div>
            </div>
        </div>

        <!-- Browser App -->
        <div id="win-browser" class="window win-border-out" style="width: 800px; height: 600px; top: 60px; left: 120px;">
            <div class="title-bar">
                <div class="flex items-center gap-2 pointer-events-none"><img src="https://api.iconify.design/flat-color-icons:globe.svg" class="w-5 h-5">Web Browser</div>
                <div class="flex gap-2">
                    <button class="win-btn px-2 text-lg" onclick="WindowManager.minimize('win-browser')">−</button>
                    <button class="win-btn px-2 text-sm" onclick="WindowManager.toggleMaximize('win-browser')">▢</button>
                    <button class="win-btn px-2 text-lg text-red-500" onclick="WindowManager.close('win-browser')">×</button>
                </div>
            </div>
            <div class="flex flex-col flex-grow h-full bg-gray-50">
                <div class="flex-grow relative bg-white">
                     <iframe id="browser-frame" src="https://vaporsite.pages.dev/scram" class="w-full h-full border-none" title="Browser Content" allow="fullscreen"></iframe>
                </div>
            </div>
        </div>

        <!-- File Explorer -->
        <div id="win-explorer" class="window win-border-out" style="width: 700px; height: 500px; top: 120px; left: 180px;">
            <div class="title-bar">
                <div class="flex items-center gap-2 pointer-events-none"><img src="https://api.iconify.design/flat-color-icons:opened-folder.svg" class="w-5 h-5">File Explorer</div>
                <div class="flex gap-2">
                    <button class="win-btn px-2 text-lg" onclick="WindowManager.minimize('win-explorer')">−</button>
                    <button class="win-btn px-2 text-sm" onclick="WindowManager.toggleMaximize('win-explorer')">▢</button>
                    <button class="win-btn px-2 text-lg text-red-500" onclick="WindowManager.close('win-explorer')">×</button>
                </div>
            </div>
            <div class="flex flex-grow overflow-hidden bg-white/90">
                <div class="w-48 border-r border-gray-200 p-2 flex flex-col gap-1 bg-gray-50/50">
                    <div class="explorer-sidebar-item" id="side-desktop" onclick="Explorer.navigate('desktop')">
                        <img src="https://api.iconify.design/flat-color-icons:icons8-cup.svg" class="w-4 h-4"> Desktop
                    </div>
                    <div class="explorer-sidebar-item" id="side-documents" onclick="Explorer.navigate('documents')">
                        <img src="https://api.iconify.design/flat-color-icons:folder.svg" class="w-4 h-4"> Documents
                    </div>
                    <div class="explorer-sidebar-item" id="side-pictures" onclick="Explorer.navigate('pictures')">
                        <img src="https://api.iconify.design/flat-color-icons:picture.svg" class="w-4 h-4"> Pictures
                    </div>
                </div>
                <div class="flex-grow flex flex-col">
                    <div class="h-10 border-b border-gray-200 flex items-center px-4 bg-white/50">
                        <div class="text-xs font-bold" id="explorer-path">This PC > Desktop</div>
                    </div>
                    <div id="explorer-grid" class="flex-grow p-4 grid grid-cols-4 md:grid-cols-6 content-start gap-2 overflow-auto"></div>
                </div>
            </div>
        </div>

        <!-- Media Viewer -->
        <div id="win-media" class="window win-border-out" style="width: 600px; height: 450px; top: 150px; left: 250px;">
            <div class="title-bar">
                <div class="flex items-center gap-2 pointer-events-none"><img src="https://api.iconify.design/flat-color-icons:landscape.svg" class="w-5 h-5">Media Viewer</div>
                <div class="flex gap-2">
                    <button class="win-btn px-2 text-lg" onclick="WindowManager.minimize('win-media')">−</button>
                    <button class="win-btn px-2 text-sm" onclick="WindowManager.toggleMaximize('win-media')">▢</button>
                    <button class="win-btn px-2 text-lg text-red-500" onclick="WindowManager.close('win-media')">×</button>
                </div>
            </div>
            <div class="window-content bg-gray-900 flex items-center justify-center p-0 overflow-hidden">
                <img id="media-content" src="" class="max-w-full max-h-full object-contain">
                <div id="media-empty" class="text-white text-sm opacity-50">No file selected</div>
            </div>
        </div>

        <!-- Settings -->
        <div id="win-settings" class="window win-border-out" style="width: 400px; height: 400px; top: 100px; left: 400px;">
            <div class="title-bar">
                <div class="flex items-center gap-2 pointer-events-none"><img src="https://api.iconify.design/flat-color-icons:settings.svg" class="w-5 h-5">Settings</div>
                <div class="flex gap-2">
                    <button class="win-btn px-2 text-lg" onclick="WindowManager.minimize('win-settings')">−</button>
                    <button class="win-btn px-2 text-sm" onclick="WindowManager.toggleMaximize('win-settings')">▢</button>
                    <button class="win-btn px-2 text-lg text-red-500" onclick="WindowManager.close('win-settings')">×</button>
                </div>
            </div>
            <div class="window-content p-4">
                <h3 class="font-bold mb-4 text-gray-800">Personalization</h3>
                <div class="win-border-in p-4 mb-4 bg-white/50">
                    <p class="text-xs mb-3 text-gray-600">Wallpaper Selection</p>
                    <div class="grid grid-cols-2 gap-3">
                        <button class="win-btn p-3 text-xs flex flex-col items-center gap-1" onclick="document.body.style.backgroundImage = 'url(https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=2072&auto=format&fit=crop)'">
                            <div class="w-full h-8 bg-blue-900 rounded"></div>
                            Space
                        </button>
                        <button class="win-btn p-3 text-xs flex flex-col items-center gap-1" onclick="document.body.style.backgroundImage = 'url(https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?q=80&w=2070&auto=format&fit=crop)'">
                             <div class="w-full h-8 bg-green-900 rounded"></div>
                            Nature
                        </button>
                    </div>
                </div>
                <p class="text-[10px] text-gray-400 mt-4">Windows 67 v2.3 - Build 2025</p>
            </div>
        </div>

        <!-- Notepad -->
        <div id="win-notepad" class="window win-border-out" style="width: 500px; height: 350px; top: 180px; left: 180px;">
            <div class="title-bar">
                <div class="flex items-center gap-2 pointer-events-none"><img src="https://api.iconify.design/flat-color-icons:document.svg" class="w-5 h-5">Notepad</div>
                <div class="flex gap-2">
                    <button class="win-btn px-2 text-lg" onclick="WindowManager.minimize('win-notepad')">−</button>
                    <button class="win-btn px-2 text-sm" onclick="WindowManager.toggleMaximize('win-notepad')">▢</button>
                    <button class="win-btn px-2 text-lg text-red-500" onclick="WindowManager.close('win-notepad')">×</button>
                </div>
            </div>
            <textarea class="w-full h-full resize-none outline-none p-4 bg-white/80" placeholder="Write here..."></textarea>
        </div>

    </div>

    <!-- Start Menu -->
    <div id="start-menu">
        <div class="flex items-center gap-3 p-3 border-b mb-2">
            <div class="w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold">U</div>
            <div><p class="font-bold text-sm">User</p></div>
        </div>
        <div class="flex-grow">
            <div class="menu-item" onclick="WindowManager.open('win-browser'); toggleStartMenu()">
                <img src="https://api.iconify.design/flat-color-icons:globe.svg" class="w-6 h-6"> Browser
            </div>
            <div class="menu-item" onclick="WindowManager.open('win-camera'); toggleStartMenu()">
                <img src="https://api.iconify.design/flat-color-icons:camera.svg" class="w-6 h-6"> Camera
            </div>
            <div class="menu-item" onclick="WindowManager.open('win-explorer'); toggleStartMenu()">
                <img src="https://api.iconify.design/flat-color-icons:opened-folder.svg" class="w-6 h-6"> Explorer
            </div>
            <div class="menu-item" onclick="WindowManager.open('win-settings'); toggleStartMenu()">
                <img src="https://api.iconify.design/flat-color-icons:settings.svg" class="w-6 h-6"> Settings
            </div>
            <div class="menu-item" onclick="WindowManager.open('win-notepad'); toggleStartMenu()">
                <img src="https://api.iconify.design/flat-color-icons:document.svg" class="w-6 h-6"> Notepad
            </div>
        </div>
    </div>

    <!-- Taskbar -->
    <div id="taskbar">
        <button id="start-btn" onclick="toggleStartMenu()">Start</button>
        <div class="flex flex-grow ml-2 gap-1" id="taskbar-apps"></div>
        <div class="px-4 text-xs font-bold text-gray-700" id="clock">12:00 PM</div>
    </div>

    <script>
        const apps = [
            { id: 'win-welcome', title: 'Welcome', icon: 'flat-color-icons:home' },
            { id: 'win-browser', title: 'Browser', icon: 'flat-color-icons:globe' },
            { id: 'win-camera', title: 'Camera', icon: 'flat-color-icons:camera' },
            { id: 'win-explorer', title: 'Explorer', icon: 'flat-color-icons:opened-folder' },
            { id: 'win-settings', title: 'Settings', icon: 'flat-color-icons:settings' },
            { id: 'win-notepad', title: 'Notepad', icon: 'flat-color-icons:document' },
            { id: 'win-media', title: 'Media', icon: 'flat-color-icons:landscape' }
        ];

        /* --- DESKTOP --- */
        const desktopContainer = document.getElementById('desktop-icons');
        apps.filter(a => a.id !== 'win-media' && a.id !== 'win-welcome').forEach(app => {
            const el = document.createElement('div');
            el.className = 'desktop-icon';
            el.innerHTML = `<img src="https://api.iconify.design/${app.icon}.svg"><span class="text-xs font-bold">${app.title}</span>`;
            el.ondblclick = () => WindowManager.open(app.id);
            desktopContainer.appendChild(el);
        });

        /* --- CAMERA --- */
        const CameraApp = {
            stream: null,
            async start() {
                const video = document.getElementById('camera-video');
                try {
                    this.stream = await navigator.mediaDevices.getUserMedia({ video: true });
                    video.srcObject = this.stream;
                } catch (err) { video.poster = "https://images.unsplash.com/photo-1516035069371-29a1b244cc32?q=80&w=400&auto=format&fit=crop"; }
            },
            stop() { if (this.stream) this.stream.getTracks().forEach(t => t.stop()); },
            takePhoto() {
                const video = document.getElementById('camera-video');
                const canvas = document.createElement('canvas');
                canvas.width = video.videoWidth || 640; canvas.height = video.videoHeight || 480;
                canvas.getContext('2d').drawImage(video, 0, 0);
                const flash = document.getElementById('camera-flash');
                flash.style.opacity = "1"; setTimeout(() => flash.style.opacity = "0", 100);
                Explorer.files.push({ name: `Photo_${Date.now()}.png`, type: 'image', location: 'pictures', data: canvas.toDataURL('image/png') });
                Explorer.render();
            }
        };

        /* --- MEDIA VIEWER --- */
        const MediaViewer = {
            open(file) {
                WindowManager.open('win-media');
                const content = document.getElementById('media-content');
                const empty = document.getElementById('media-empty');
                content.src = file.data;
                content.style.display = 'block';
                empty.style.display = 'none';
            }
        };

        /* --- EXPLORER --- */
        const Explorer = {
            files: [
                { name: 'Beach.jpg', type: 'image', location: 'pictures', data: 'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?q=80&w=400&auto=format&fit=crop' },
                { name: 'Mountain.jpg', type: 'image', location: 'pictures', data: 'https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?q=80&w=400&auto=format&fit=crop' },
                { name: 'Readme.txt', type: 'document', location: 'desktop' }
            ],
            currentLocation: 'desktop',
            navigate(loc) {
                this.currentLocation = loc;
                document.querySelectorAll('.explorer-sidebar-item').forEach(i => i.classList.remove('active'));
                document.getElementById(`side-${loc}`)?.classList.add('active');
                document.getElementById('explorer-path').innerText = `This PC > ${loc.charAt(0).toUpperCase() + loc.slice(1)}`;
                this.render();
            },
            render() {
                const grid = document.getElementById('explorer-grid');
                grid.innerHTML = '';
                this.files.filter(f => f.location === this.currentLocation).forEach(file => {
                    const el = document.createElement('div');
                    el.className = 'file-grid-item';
                    el.innerHTML = file.type === 'image' ? 
                        `<img src="${file.data}" class="w-10 h-10 object-cover mb-2 rounded border border-gray-200"><span class="text-[10px] font-bold truncate w-full">${file.name}</span>` :
                        `<img src="https://api.iconify.design/flat-color-icons:document.svg" class="w-10 h-10 mb-2"><span class="text-[10px] font-bold truncate w-full">${file.name}</span>`;
                    el.ondblclick = () => { if (file.type === 'image') MediaViewer.open(file); };
                    grid.appendChild(el);
                });
            }
        };

        /* --- WINDOWS --- */
        const WindowManager = {
            zIndex: 100,
            windows: {},
            init() {
                document.querySelectorAll('.window').forEach(win => {
                    const titleBar = win.querySelector('.title-bar');
                    this.makeDraggable(win, titleBar);
                    win.addEventListener('mousedown', () => this.bringToFront(win.id));
                    
                    const resizer = win.querySelector('.resize-handle') || document.createElement('div');
                    resizer.className = 'resize-handle';
                    win.appendChild(resizer);
                    this.makeResizable(win, resizer);

                    this.windows[win.id] = { isOpen: false, isMinimized: false, isMaximized: false, oldPos: null };
                });
                this.open('win-welcome');
                Explorer.navigate('desktop');
            },
            open(id) {
                const win = document.getElementById(id);
                win.style.display = 'flex';
                this.windows[id].isOpen = true;
                this.windows[id].isMinimized = false;
                if (id === 'win-camera') CameraApp.start();
                this.bringToFront(id);
                this.renderTaskbar();
            },
            close(id) {
                document.getElementById(id).style.display = 'none';
                this.windows[id].isOpen = false;
                this.renderTaskbar();
            },
            minimize(id) {
                document.getElementById(id).style.display = 'none';
                this.windows[id].isMinimized = true;
                this.renderTaskbar();
            },
            toggleMaximize(id) {
                const win = document.getElementById(id);
                const state = this.windows[id];
                if (state.isMaximized) {
                    win.classList.remove('maximized');
                    win.style.width = state.oldPos.w;
                    win.style.height = state.oldPos.h;
                    win.style.top = state.oldPos.t;
                    win.style.left = state.oldPos.l;
                    state.isMaximized = false;
                } else {
                    state.oldPos = {
                        w: win.style.width,
                        h: win.style.height,
                        t: win.style.top,
                        l: win.style.left
                    };
                    win.classList.add('maximized');
                    state.isMaximized = true;
                }
            },
            bringToFront(id) {
                this.zIndex++;
                document.getElementById(id).style.zIndex = this.zIndex;
            },
            renderTaskbar() {
                const container = document.getElementById('taskbar-apps');
                container.innerHTML = '';
                Object.keys(this.windows).forEach(id => {
                    if (this.windows[id].isOpen) {
                        const app = apps.find(a => a.id === id);
                        const btn = document.createElement('div');
                        btn.className = 'taskbar-item cursor-pointer ' + (!this.windows[id].isMinimized ? 'active' : 'opacity-60');
                        btn.innerHTML = `<img src="https://api.iconify.design/${app.icon}.svg">`;
                        btn.title = app.title;
                        btn.onclick = () => this.open(id);
                        container.appendChild(btn);
                    }
                });
            },
            
            // OPTIMIZED DRAGGING with requestAnimationFrame
            makeDraggable(el, handle) {
                let px = 0, py = 0;
                let isDragging = false;
                let rafId = null;

                const onMouseDown = (e) => {
                    if (this.windows[el.id].isMaximized) return;
                    if (e.target.tagName === 'BUTTON') return;
                    
                    isDragging = true;
                    document.body.classList.add('dragging');
                    px = e.clientX; 
                    py = e.clientY;

                    document.addEventListener('mousemove', onMouseMove);
                    document.addEventListener('mouseup', onMouseUp);
                };

                const onMouseMove = (e) => {
                    if (!isDragging) return;
                    
                    // Throttle updates to screen refresh rate
                    if (rafId) cancelAnimationFrame(rafId);
                    
                    rafId = requestAnimationFrame(() => {
                        const dx = px - e.clientX;
                        const dy = py - e.clientY;
                        px = e.clientX;
                        py = e.clientY;
                        
                        el.style.top = (el.offsetTop - dy) + "px";
                        el.style.left = (el.offsetLeft - dx) + "px";
                    });
                };

                const onMouseUp = () => {
                    isDragging = false;
                    document.body.classList.remove('dragging');
                    if (rafId) cancelAnimationFrame(rafId);
                    document.removeEventListener('mousemove', onMouseMove);
                    document.removeEventListener('mouseup', onMouseUp);
                };

                handle.addEventListener('mousedown', onMouseDown);
            },

            makeResizable(element, handle) {
                let isResizing = false;
                let rafId = null;

                handle.addEventListener('mousedown', (e) => {
                    if (this.windows[element.id].isMaximized) return;
                    e.preventDefault();
                    e.stopPropagation();
                    
                    isResizing = true;
                    document.body.classList.add('dragging');
                    
                    const startX = e.clientX;
                    const startY = e.clientY;
                    const startWidth = parseInt(document.defaultView.getComputedStyle(element).width, 10);
                    const startHeight = parseInt(document.defaultView.getComputedStyle(element).height, 10);

                    const doDrag = (e) => {
                        if (!isResizing) return;
                        if (rafId) cancelAnimationFrame(rafId);
                        
                        rafId = requestAnimationFrame(() => {
                            element.style.width = (startWidth + e.clientX - startX) + 'px';
                            element.style.height = (startHeight + e.clientY - startY) + 'px';
                        });
                    };

                    const stopDrag = () => {
                        isResizing = false;
                        document.body.classList.remove('dragging');
                        if (rafId) cancelAnimationFrame(rafId);
                        document.removeEventListener('mousemove', doDrag);
                        document.removeEventListener('mouseup', stopDrag);
                    };

                    document.addEventListener('mousemove', doDrag);
                    document.addEventListener('mouseup', stopDrag);
                });
            }
        };

        function toggleStartMenu() {
            const menu = document.getElementById('start-menu');
            menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
        }

        setInterval(() => {
            const now = new Date();
            document.getElementById('clock').innerText = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }, 1000);

        WindowManager.init();
    </script>
</body>
</html>


</body>
</html>